<!doctype html>
<html lang="en" class="no-js">
<head>
	<meta charset="utf-8" />
	<title>Reflection V2, Data Lab, Top Downloads</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<!--[if (gt IE 9)|(IEMobile)|(!IE)]><!-->
		<link rel="stylesheet" type="text/css" href="reflection-main-v2.css" />
	<!--<![endif]-->
	<!--[if IE 9]>
		<link rel="stylesheet" type="text/css" href="ie9-v2-one.css" />
		<link rel="stylesheet" type="text/css" href="ie9-v2-two.css" />
	<![endif]-->
	<!--[if (lt IE 9)]>
		<script src="js/vendor/html5shiv.min.js"></script>
		<link rel="stylesheet" media="screen, projection" type="text/css" href="reflection-main-ie8.css" />
	<![endif]-->
	<link rel="stylesheet" href="js/vendor/jquery.mCustomScrollbar.css" />
<script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
<script>
  WebFont.load({
    google: {
      families: ['Source Sans Pro:400,600,700', 'Lato:400,700,400italic']
    }
  });
</script></head>
<body>
	<!--[if (lt IE 9)]>
      <div class="window-warning">
  			<p>Uh oh... Reflection doesn't work in this browser. &nbsp; &nbsp;<a href="http://outdatedbrowser.com/en" target="_blank">Download a compatible browser</a></p>
  		</div>
  <![endif]-->

  <header id="js-component-import--global-header" class="global-header"></header>
  
	<div id="js-component-import--panel-left" class="panel-left js-panel-left js-custom-scrollbar" data-mcs-theme="minimal-dark"></div>

	<div class="l-page-container">
		<div id="main" class="l-main" role="main">
			<div class="page-lab-base data-vis-making-top-charts grid-container is-loading js-page-container theme-dark">
				
				<div class="grid__row grid__row--heading-row">
					<div class="grid__row--heading-row__left">
						<h1 class="heading-style--heading-three page-title">What Downloads or Revenue are Needed to Break into the Top Charts?</h1>
					</div>
					<div class="grid__row--heading-row__right">
						<button class="ref-button--primary--medium">
	 						Share This
	 					</button>
					</div>
					<div class="filters-row">
						<span class="filter-label">To Break Into</span>
						<div class="secondary-filter secondary-filter--medium form-field--select js-secondary-filter js-dropdown-rank">
							<select class="js-select-box">
						    <option value="200" selected>Top 200 Apps</option>
						    <option value="150">Top 150 Apps</option>
						    <option value="100">Top 100 Apps</option>
						    <option value="50">Top 50 Apps</option>
						    <option value="20">Top 20 Apps</option>
						    <option value="10">Top 10 Apps</option>
							</select>
						</div>
						<div class="secondary-filter secondary-filter--medium form-field--select js-secondary-filter js-dropdown-country">
							<select class="js-select-box">
						    <option value="GB" selected>United Kingdom</option>
						    <option value="US">USA</option>
						    <option value="FR">France</option>
						    <option value="IT">Italy</option>
						    <option value="DE">Germany</option>
							</select>
						</div>
						<span class="filter-label"><a href="#" class="js-onboarding-link">What's This Showing Me?</a></span>
						<div class="filters-right">
							<span class="filter-label">Show Data For</span>
							<div class="secondary-filter secondary-filter--medium form-field--select js-secondary-filter js-dropdown-device">
								<select class="js-select-box">
							    <option value="PHONE" selected>iPhone</option>
							    <option value="TABLET">iPad</option>
								</select>
							</div>
						</div>
					</div>
				</div>

				<div class="grid__row data-vis-making-top-charts__main">

					<div class="data-vis-making-top-charts__categories">
						<h2>Category</h2>
						<ul class="js-category-list">
							<li class="data-vis-making-top-charts__category"><span>Overall</span></li>
							<li class="data-vis-making-top-charts__category data-vis-making-top-charts__category--has-subcategories js-has-subcategories">
								<span class="ref-icon-after--angle-down">Games</span>
								<ul>
									<li class="data-vis-making-top-charts__sub-category"><span>Action</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Adventure</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Arcade</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Board</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Card</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Casino</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Dice</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Educational</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Family</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Music Games</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Puzzle</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Racing</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Role Playing</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Simulation</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Sports Games</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Strategy</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Trivia</span></li>
									<li class="data-vis-making-top-charts__sub-category"><span>Word</span></li>
								</ul>
							</li>
							<li class="data-vis-making-top-charts__category"><span>Books</span></li>
							<li class="data-vis-making-top-charts__category"><span>Business</span></li>
							<li class="data-vis-making-top-charts__category"><span>Catalogs</span></li>
							<li class="data-vis-making-top-charts__category"><span>Education</span></li>
							<li class="data-vis-making-top-charts__category"><span>Entertainment</span></li>
							<li class="data-vis-making-top-charts__category"><span>Finance</span></li>
							<li class="data-vis-making-top-charts__category"><span>Food &amp; Drink</span></li>
							<li class="data-vis-making-top-charts__category"><span>Health &amp; Fitness</span></li>
							<li class="data-vis-making-top-charts__category"><span>Lifestyle</span></li>
							<li class="data-vis-making-top-charts__category"><span>Medical</span></li>
							<li class="data-vis-making-top-charts__category"><span>Music</span></li>
							<li class="data-vis-making-top-charts__category"><span>Navigation</span></li>
							<li class="data-vis-making-top-charts__category"><span>Newsstand</span></li>
							<li class="data-vis-making-top-charts__category"><span>News</span></li>
							<li class="data-vis-making-top-charts__category"><span>Photo &amp; Video</span></li>
							<li class="data-vis-making-top-charts__category"><span>Productivity</span></li>
							<li class="data-vis-making-top-charts__category"><span>Reference</span></li>
							<li class="data-vis-making-top-charts__category"><span>Shopping</span></li>
							<li class="data-vis-making-top-charts__category"><span>Social Networking</span></li>
							<li class="data-vis-making-top-charts__category"><span>Sports</span></li>
							<li class="data-vis-making-top-charts__category"><span>Travel</span></li>
							<li class="data-vis-making-top-charts__category"><span>Utilities</span></li>
							<li class="data-vis-making-top-charts__category"><span>Weather</span></li>
						</ul>
					</div>
					<div class="chart__loading">
						<div class="hamster-wheel">
							<img src="images/hamster-wheel-dark.png" alt="hamster wheel">
						</div>
						<div class="animation-hamster animation-hamster--dark"></div>
					</div>
					<div class="data-vis-making-top-charts__data-container">
						<div class="data-vis-making-top-charts__data-column">
							<h2 class="ref-icon-before--download">Downloads To Be in Free List</h2>
							<ul class="js-downloads-free-list">
								<li class="data-vis-making-top-charts__item" data-id="Overall"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item data-vis-making-top-charts__item--has-sub-items" data-id="Games">
									<span class="data-bar"></span>
									<ul>
										<li class="data-vis-making-top-charts__item" data-id="Action"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Adventure"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Arcade"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Board"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Card"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Casino"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Dice"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Educational"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Family"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="MusicGames"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Puzzle"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Racing"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="RolePlaying"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Simulation"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="SportsGames"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Strategy"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Trivia"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Word"><span class="data-bar"></span></li>
									</ul>
								<li class="data-vis-making-top-charts__item" data-id="Books"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Business"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Catalogs"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Education" ><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Entertainment"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Finance"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="FoodDrink"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="HealthFitness"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Lifestyle"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Medical"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Music"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Navigation"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Newsstand"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="News"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="PhotoVideo"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Productivity"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Reference"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Shopping"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="SocialNetworking"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Sports"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Travel"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Utilities"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Weather"><span class="data-bar"></span></li>
							</ul>
						</div>

						<div class="data-vis-making-top-charts__data-column">
							<h2 class="ref-icon-before--download">Downloads To Be in Paid List</h2>
							<ul class="js-downloads-paid-list">
								<li class="data-vis-making-top-charts__item" data-id="Overall"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item data-vis-making-top-charts__item--has-sub-items" data-id="Games">
									<span class="data-bar"></span>
									<ul>
										<li class="data-vis-making-top-charts__item" data-id="Action"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Adventure"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Arcade"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Board"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Card"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Casino"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Dice"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Educational"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Family"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="MusicGames"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Puzzle"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Racing"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="RolePlaying"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Simulation"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="SportsGames"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Strategy"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Trivia"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Word"><span class="data-bar"></span></li>
									</ul>
								<li class="data-vis-making-top-charts__item" data-id="Books"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Business"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Catalogs"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Education" ><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Entertainment"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Finance"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="FoodDrink"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="HealthFitness"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Lifestyle"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Medical"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Music"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Navigation"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Newsstand"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="News"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="PhotoVideo"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Productivity"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Reference"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Shopping"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="SocialNetworking"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Sports"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Travel"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Utilities"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Weather"><span class="data-bar"></span></li>
							</ul>
						</div>

						<div class="data-vis-making-top-charts__data-column data-vis-making-top-charts__data-column--revenue">
							<h2 class="ref-icon-before--revenue">Revenue To Be in Grossing List</h2>
							<ul class="js-revenue-grossing-list">
								<li class="data-vis-making-top-charts__item" data-id="Overall"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item data-vis-making-top-charts__item--has-sub-items" data-id="Games">
									<span class="data-bar"></span>
									<ul>
										<li class="data-vis-making-top-charts__item" data-id="Action"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Adventure"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Arcade"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Board"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Card"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Casino"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Dice"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Educational"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Family"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="MusicGames"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Puzzle"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Racing"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="RolePlaying"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Simulation"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="SportsGames"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Strategy"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Trivia"><span class="data-bar"></span></li>
										<li class="data-vis-making-top-charts__item" data-id="Word"><span class="data-bar"></span></li>
									</ul>
								<li class="data-vis-making-top-charts__item" data-id="Books"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Business"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Catalogs"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Education" ><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Entertainment"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Finance"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="FoodDrink"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="HealthFitness"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Lifestyle"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Medical"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Music"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Navigation"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Newsstand"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="News"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="PhotoVideo"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Productivity"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Reference"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Shopping"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="SocialNetworking"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Sports"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Travel"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Utilities"><span class="data-bar"></span></li>
								<li class="data-vis-making-top-charts__item" data-id="Weather"><span class="data-bar"></span></li>
							</ul>
						</div>
					</div>
				</div>

			</div>
		</div>
	</div>

	<div id="js-component-import--account-container" class="panel-right-container js-account-container"></div>
	<div id="js-component-import--search-container" class="panel-right-container js-search-container"></div>

 	<script src="js/vendor/jquery-1.11.1.min.js"></script>
 	<script src="js/vendor/handlebars-v2.0.0.js"></script> <!-- static templates only -->
 	<script src="js-v2/templates/templates.js"></script> <!-- static templates only -->
 	<script src="js/vendor/modernizr.2.8.3.custom.min.js"></script>

	<!--[if IE 9]>
		<script src="js/vendor/jquery.mCustomScrollbar.concat.min.js"></script>
	<![endif]-->

	<div id="js-appendScriptsContainer"></div>

	<script src="js-v2/app-include-templates.js"></script> <!-- static templates only -->
  <script src="js-v2/application.js"></script>

  <script>

  	$(window).on("load", function(){
		  new Page();

		  var FilterDropDown = function($domElement) {

				var $thisSelectBox = $domElement,
						$dropDownContainer = $("<ul>").addClass("form-field--select__dropdown"),
						$currentValue = $("<span>").addClass("form-field--select__box ref-icon-after--angle-down js-dropdown-trigger");

				$thisSelectBox.find('option').each(function(){
					
					var $thisOption = $(this),
							selectedClass = "";

					if($thisOption.val() != "") {

						if($thisOption.is(":selected")) {
							if($thisOption.val() != "") {
								selectedClass = "is-selected";
								$currentValue.text($thisOption.text());
							}
						}

						var $newListItem = $("<li>");
						$dropDownContainer.append($newListItem
																					.addClass("js-dropdown-option")																		
																					.addClass(selectedClass)
																					.attr('data-value', $thisOption.attr('value'))
																					.on("click", function() {

																						// check the user role

																						// if user has permission
																							// $('.js-page-container').addClass('is-loading');
																							$('.data-value').remove();

																							$thisSelectBox.find("option").removeAttr("selected");
																							$thisOption.attr("selected", "selected");
																							$currentValue.text($thisOption.text());
																							$dropDownContainer.toggle();
																							$thisSelectBox.parent("div").toggleClass("is-open");
																							$thisSelectBox.parent("div").removeClass("nothing-selected");
																							$dropDownContainer.find(".is-selected").removeClass("is-selected");
																							$(this).addClass("is-selected");																						

																							// request data based on filters
																							var selectedCountry = $('.js-dropdown-country .js-dropdown-option.is-selected').data("value");
																							var selectedRank = $('.js-dropdown-rank .js-dropdown-option.is-selected').data("value");
																							var selectedDevice = $('.js-dropdown-device .js-dropdown-option.is-selected').data("value");

																							console.log(selectedCountry);
																							console.log(selectedRank);
																							console.log(selectedDevice);

																							var fileToRequest = "js/data-lab/whatyouneed_" + selectedCountry + "_July.json";
																							console.log(fileToRequest);

																							loadData(fileToRequest, selectedRank, selectedDevice);

																						// else
																							//show sign up popup																						

																					})
																					.append($("<span>").text($thisOption.text()))
																		);
					} else {
						// no option value means placeholder text before option is selected
						$currentValue.text($thisOption.text());
					}

				});

				$currentValue.on("click", function(){
					if(!$thisSelectBox.attr("disabled")) {
						var $parentDiv = $thisSelectBox.parent("div");
						if($parentDiv.hasClass("is-open")) {
							$dropDownContainer.toggle();	
							$parentDiv.toggleClass("is-open");
						} else {
							setTimeout(function(){
								if(!$parentDiv.hasClass("is-open")) {
									closeAllFilters();
								}
								var parentWidth = $parentDiv.width();
								var parentHeight = $parentDiv.height();
								$dropDownContainer.css({"min-width": parentWidth + "px"});
								$dropDownContainer.toggle();	
								$parentDiv.toggleClass("is-open");
							}, 50); // allow time for instance.closeAllFilters() to close other filters first
						}
					}
				});

				if($currentValue.text() == "") {
					$thisSelectBox.parent("div").addClass("nothing-selected");
				}

				$thisSelectBox.parent("div").append($currentValue)
																		.append($dropDownContainer);
			};

			function closeAllFilters() {
				$('.js-secondary-filter.is-open .form-field--select__dropdown').hide();
				$('.js-secondary-filter.is-open').removeClass("is-open");
			}

			$("html").on("click", function(e){
				if(!$(e.target).hasClass("js-no-close-on-click") && !$(e.target).hasClass("js-clear-all")) {
					closeAllFilters();	
				}
			});

		  $('.js-select-box').each(function() {
  			new FilterDropDown($(this));
  		});

  		$('.js-has-subcategories').on("click", function(){
  			$('.js-page-container').toggleClass("is-showing-subcategories");
  		});

		  function getMaxValueFromArray(list) {
				var mx = 0;
				for(var x = 0; x < list.length; x++) {
					if(list[x].value > mx) {
						mx = list[x].value;
					}
				}

				return mx;
			}

			function outputResults(dataArray, outputContainerClass, valuePrefix, maxGrossing) {
					$.each(dataArray, function(){
						var id = this.id;
						if(id.indexOf("&") != -1) {
							id = id.replace("&", "");
						}
						var spanWidth = (this.value / maxGrossing) * 100;
						var thisValue = valuePrefix + this.value;
						var noDataCSSClass = "";
						if(this.value == undefined || this.value <= 0) {
							console.log(this.value);
							thisValue = "No data"
							noDataCSSClass = "is-no-data";
						}
						var valueSpan = $("<span>").text(thisValue).addClass("data-value").addClass(noDataCSSClass);
						valueSpan.append($("<span>").text(this.name).addClass("data-name"));
						$('.' + outputContainerClass + ' .data-vis-making-top-charts__item[data-id=' + id + '] > .data-bar').width(spanWidth + "%");

						$('.' + outputContainerClass + ' .data-vis-making-top-charts__item[data-id=' + id + ']').append(valueSpan);
					});


			}

			function loadData(fileToRequest, selectedRank, selectedDevice) {
				// get default data
				$.getJSON( fileToRequest, function( data ) {

					console.log(data);

					$('.js-page-container').removeClass('is-loading');
					
					if(data[selectedRank][selectedDevice]["GROSSING"].categories.length > 0) {
						var maxGrossing = getMaxValueFromArray(data[selectedRank][selectedDevice]["GROSSING"].categories);
						outputResults(data[selectedRank][selectedDevice]["GROSSING"].categories, "js-revenue-grossing-list", "$", maxGrossing);
					}

					if(data[selectedRank][selectedDevice]["GROSSING"].subcategories.length > 0) {
						var maxGrossing = getMaxValueFromArray(data[selectedRank][selectedDevice]["GROSSING"].categories);
						outputResults(data[selectedRank][selectedDevice]["GROSSING"].subcategories, "js-revenue-grossing-list", "$", maxGrossing);
					}

					if(data[selectedRank][selectedDevice]["FREE"].categories.length > 0) {
						var maxGrossing = getMaxValueFromArray(data[selectedRank][selectedDevice]["FREE"].categories);
						outputResults(data[selectedRank][selectedDevice]["FREE"].categories, "js-downloads-free-list", "", maxGrossing);
					}

					if(data[selectedRank][selectedDevice]["FREE"].subcategories.length > 0) {
						var maxGrossing = getMaxValueFromArray(data[selectedRank][selectedDevice]["FREE"].categories);
						outputResults(data[selectedRank][selectedDevice]["FREE"].subcategories, "js-downloads-free-list", "", maxGrossing);
					}

					if(data[selectedRank][selectedDevice]["PAID"].categories.length > 0) {
						var maxGrossing = getMaxValueFromArray(data[selectedRank][selectedDevice]["PAID"].categories);
						outputResults(data[selectedRank][selectedDevice]["PAID"].categories, "js-downloads-paid-list", "", maxGrossing);
					}

					if(data[selectedRank][selectedDevice]["PAID"].subcategories.length > 0) {
						var maxGrossing = getMaxValueFromArray(data[selectedRank][selectedDevice]["PAID"].categories);
						outputResults(data[selectedRank][selectedDevice]["PAID"].subcategories, "js-downloads-paid-list", "", maxGrossing);
					}

				});
			}

			setTimeout(function(){ loadData("js/data-lab/whatyouneed_GB_July.json", "200", "PHONE"); }, 1000);

  	});
  </script>
</body>